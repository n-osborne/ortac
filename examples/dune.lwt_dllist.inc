; This file is generated by ortac dune qcheck-stm
; It contains the rules for generating and running QCheck-STM tests for lwt_dllist_spec
; It also contains the rule to generate itself, so you can edit this rule to
; change some options rather that running ortac on the command line again

(rule
 (alias runtest)
 (mode promote)
 (deps
  (package ortac-dune))
 (package ortac-examples)
 (targets dune.lwt_dllist.inc)
 (action
  (setenv
   ORTAC_ONLY_PLUGIN
   dune-rules
   (run
    ortac
    dune
    qcheck-stm
    lwt_dllist_spec
    "create ()"
    "int t"
    lwt_dllist_tests
    --include=lwt_dllist_incl
    --package=ortac-examples
    --with-stdout-to=dune.lwt_dllist.inc))))

(rule
 (alias runtest)
 (mode promote)
 (package ortac-examples)
 (deps
  (package ortac-qcheck-stm))
 (targets lwt_dllist_tests.ml)
 (action
  (setenv
   ORTAC_ONLY_PLUGIN
   qcheck-stm
   (with-stdout-to
    %{targets}
    (run
     ortac
     qcheck-stm
     %{dep:lwt_dllist_spec.mli}
     "create ()"
     "int t"
     --include=lwt_dllist_incl
     --quiet)))))

(test
 (name lwt_dllist_tests)
 (modules lwt_dllist_tests lwt_dllist_incl)
 (libraries
  lwt_dllist_spec
  qcheck-stm.stm
  qcheck-stm.sequential
  qcheck-multicoretests-util
  ortac-runtime-qcheck-stm)
 (package ortac-examples)
 (action
  (run
   %{test}
   --verbose)))
